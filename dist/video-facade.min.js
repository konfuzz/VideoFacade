!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";class t extends HTMLElement{constructor(){super();this.attachShadow({mode:"open"}).innerHTML='\n      <style>\n        :host {\n          position: relative;\n          background-size: cover;\n          background-position: center;\n          background-repeat: no-repeat;\n          overflow: hidden;\n          display: flex;\n          justify-content: center;\n          align-items: center;\n        }\n        video, [data-vimeo-url] {\n          min-width: 100%;\n          min-height: 100%;\n          object-fit: cover;\n          display: block;\n        }\n        [data-vimeo-url] {\n          height: 100%;\n        }\n        iframe {\n          width: 100%;\n          height: 100%;\n        }\n        .standard-play-button {\n          position:absolute;\n          top: 50%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n          background: white;\n          border: none;\n          cursor: pointer;\n          padding: 0;\n          margin: 0;\n          width: 15%;\n          aspect-ratio: 1;\n          color: red;\n          border-radius: 50%;\n          backdrop-filter: blur(10px);\n        }\n        .hidden {\n          display: none !important;\n        }\n        :host(.bg) {\n          pointer-events: none;\n        }\n        .standard-play-button svg {\n          width: 60%;\n          transform: translate(8%, 5%);\n        }\n      </style>\n\n      <video></video>\n      <slot name="play-button">\n        <button class="standard-play-button" aria-label="Play video">\n          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <path d="M16.6582 9.28638C18.098 10.1862 18.8178 10.6361 19.0647 11.2122C19.2803 11.7152 19.2803 12.2847 19.0647 12.7878C18.8178 13.3638 18.098 13.8137 16.6582 14.7136L9.896 18.94C8.29805 19.9387 7.49907 20.4381 6.83973 20.385C6.26501 20.3388 5.73818 20.0469 5.3944 19.584C5 19.053 5 18.1108 5 16.2264V7.77357C5 5.88919 5 4.94701 5.3944 4.41598C5.73818 3.9531 6.26501 3.66111 6.83973 3.6149C7.49907 3.5619 8.29805 4.06126 9.896 5.05998L16.6582 9.28638Z" stroke="#000000" stroke-width="2" stroke-linejoin="round"/>\n          </svg>\n        </button>\n      </slot>\n    '}connectedCallback(){this.video=this.shadowRoot.querySelector("video"),this.playBtn=this.getPlayButton(),this.poster=this.getAttribute("poster"),this.src=this.getAttribute("src"),this.type=this.getAttribute("type")||"native",this.options=this.getAttribute("options")?.split(" ")||[],this.lazy=this.getAttribute("lazy")||!1,this.autopause=this.hasAttribute("autopause"),this.threshold=this.getAttribute("threshold"),this.pauseOnClick=this.hasAttribute("pauseonclick")||!1,this.bgVideo=this.hasAttribute("bg")||!1,this.bgVideo&&(this.options.push("muted","autoplay"),this.playBtn.classList.add("hidden"),this.shadowRoot.host.classList.add("bg")),this.style.backgroundImage=`url("${this.poster}")`,this.bgVideo&&!this.lazy&&this.videoInit(!0),"onload"===this.lazy&&window.addEventListener("load",(()=>this.options.includes("autoplay")?this.videoInit(!0):this.videoInit())),this.playBtn.addEventListener("click",(async()=>this.videoLoaded?this.video.play():await this.videoInit(!0))),this.pauseOnClick&&this.addEventListener("click",(()=>this.isPlaying&&this.video.pause())),("inview"===this.lazy||this.autopause)&&this.observeVideo()}play(){this.videoLoaded&&!this.isPlaying&&this.video.play()}pause(){this.videoLoaded&&this.isPlaying&&this.video.pause()}async videoInit(t){if(!this.videoLoaded){switch(this.type){case"vimeo":await this.vimeoInit();break;case"youtube":await this.youtubeInit();break;default:this.nativeInit()}this.videoLoaded=!0,t&&this.video.play()}}nativeInit(){this.video.src=this.src,this.video.poster=this.poster;for(const t of this.options)this.video[t]=!0,this.video.setAttribute(t,"");this.video.addEventListener("loadeddata",(()=>{this.videoLoaded=!0})),this.video.addEventListener("play",(()=>{this.playBtn.style.display="none",this.isPlaying=!0})),this.video.addEventListener("pause",(()=>{this.playBtn.style.display="block",this.isPlaying=!1}))}async youtubeInit(){return new Promise((async(t,i)=>{try{await this.loadPlayer("youtube");const i=document.createElement("div");let s={rel:0,controls:0,showinfo:0,modestbranding:0};for(const t of this.options)s[t]=1;this.video.replaceWith(i);const n=()=>{this.video.muted=!0,this.video.play()},e=()=>{s.autoplay&&this.video.mute(),this.video.play=this.video.playVideo,this.video.pause=this.video.pauseVideo,this.videoLoaded=!0,t()},o=t=>{t.data===YT.PlayerState.PLAYING?(this.isPlaying=!0,this.playBtn.style.display="none"):t.data===YT.PlayerState.PAUSED&&(this.isPlaying=!1,this.playBtn.style.display="block")};this.video=new YT.Player(i,{videoId:this.src,playerVars:s,events:{onReady:e,onStateChange:o,onAutoplayBlocked:n}})}catch(t){console.error(t),i(t)}}))}async vimeoInit(){try{await this.loadPlayer("vimeo");const t=document.createElement("div");t.setAttribute("data-vimeo-url",this.src),this.options.includes("controls")||(t.style.pointerEvents="none"),this.video.replaceWith(t),this.video=new Vimeo.Player(t,{autoplay:this.options.includes("autoplay"),muted:this.options.includes("muted"),controls:this.options.includes("controls")}),this.video.on("loaded",(()=>{this.videoLoaded=!0,this.video.on("play",(()=>{this.playBtn.style.display="none",this.isPlaying=!0})),this.video.on("pause",(()=>{this.playBtn.style.display="block",this.isPlaying=!1}))}))}catch(t){console.log(t)}}getPlayButton(){const t=this.shadowRoot.querySelector("slot");return t.assignedElements().length?t.assignedElements()[0]:t}observeVideo(){const t=new IntersectionObserver((i=>{i.forEach((i=>{i.isIntersecting&&"inview"===this.lazy&&(this.videoLoaded?this.options.includes("autoplay")&&this.video.play():this.videoInit(),t.disconnect())}))}),{threshold:this.threshold||0});t.observe(this);const i=new IntersectionObserver((async t=>{t.forEach((t=>{this.autopause&&this.videoLoaded&&(this.isPlaying?this.video.pause():this.video.play())}))}),{threshold:this.threshold||0});i.observe(this),this.t=i}async loadPlayer(t){return new Promise(((i,s)=>{("youtube"===t&&window.YT||"vimeo"===t&&window.Vimeo)&&i();const n=document.createElement("script");if("vimeo"===t)n.src="https://player.vimeo.com/api/player.js";else{if("youtube"!==t)return void s(new Error("Unsupported player type"));n.src="https://www.youtube.com/iframe_api"}n.onload=()=>{"youtube"===t?window.onYouTubeIframeAPIReady=()=>{console.log("YouTube API is ready"),i()}:(console.log("Vimeo player loaded successfully"),i())},n.onerror=()=>{console.error(`Failed to load ${t} player.`),s(new Error(`Failed to load ${t} player script.`))},document.body.appendChild(n)}))}disconnectedCallback(){this.t?.disconnect()}}customElements.define("video-facade",t)}));
